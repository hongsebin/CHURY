{% extends 'common/base.html' %}

{% block title %}HOME{% endblock %}

{% block body %}
    
<div class="h1">도서 검색</div>
<form action="{% url 'board:search' %}" method="get" id="searchForm">
    <div class="col-8">
        <div class="input-group">
            <input type="hidden" id="page" name="page" value="1">
            <select name="searchType" class="form-select">
                {% if searchType == 'title' %}
                <option value="title" selected="selected">제목별</option>
                {% else %}
                <option value="title">제목별</option>
                {% endif %}
                {% if searchType == 'author' %}
                <option value="author" selected="selected">저자별</option>
                {% else %}
                <option value="author">저자별</option>
                {% endif %}
                {% if searchType == 'category' %}
                <option value="category" selected="selected">장르별</option>
                {% else %}
                <option value="category">장르별</option>
                {% endif %}
            </select>
            <input type="text" name="searchWord" class="form-control" value="{{ pr_text|default_if_none:'' }}">
            <button type="submit" class="btn btn-info">검색</button>
            <div class="col-2"></div>
            <div class="col-3">
                {% if searchType == 'title' %}
                <select name="sortType" class="form-select" onchange="this.form.submit()">
                    {% if sortType == 'PublishTime' %}
                    <option value="PublishTime" selected="selected">출간일 순</option>
                    {% else %}
                    <option value="PublishTime">출간일 순</option>
                    {% endif %}
                    {% if sortType == 'SalesPoint' %}
                    <option value="SalesPoint" selected="selected">판매량 순</option>
                    {% else %}
                    <option value="SalesPoint">판매량 순</option>
                    {% endif %}
                    {% if sortType == 'CustomerRating' %}
                    <option value="CustomerRating" selected="selected">고객평점 순</option>
                    {% else %}
                    <option value="CustomerRating">고객평점 순</option>
                    {% endif %}
                </select>
                {% elif searchType == 'author' %}
                <select name="sortType" class="form-select" onchange="this.form.submit()">
                    {% if sortType == 'PublishTime' %}
                    <option value="PublishTime" selected="selected">출간일 순</option>
                    {% else %}
                    <option value="PublishTime">출간일 순</option>
                    {% endif %}
                    {% if sortType == 'SalesPoint' %}
                    <option value="SalesPoint" selected="selected">판매량 순</option>
                    {% else %}
                    <option value="SalesPoint">판매량 순</option>
                    {% endif %}
                    {% if sortType == 'CustomerRating' %}
                    <option value="CustomerRating" selected="selected">고객평점 순</option>
                    {% else %}
                    <option value="CustomerRating">고객평점 순</option>
                    {% endif %}
                </select>
                {% elif searchType == 'category' %}
                <select name="queryType" class="form-select" onchange="this.form.submit()">
                    {% if queryType == 'Bestseller' %}
                    <option value="Bestseller" selected="selected">베스트셀러</option>
                    {% else %}
                    <option value="Bestseller">베스트셀러</option>
                    {% endif %}
                    {% if queryType == 'ItemNewAll' %}
                    <option value="ItemNewAll" selected="selected">신간</option>
                    {% else %}
                    <option value="ItemNewAll">신간</option>
                    {% endif %}
                </select>
                {% endif %}
            </div>
        </div>
    </div>
</form>    
<table>
    <tbody>
        {% if response.errorCode == 3 %}
        검색어를 입력해주세요.
        {% elif pr_text == '' %}
        검색어를 입력해주세요.
        {% elif response.item %}
        <tr>
            {% if searchType == 'title' %}
            '{{ pr_text }}'에 대한 검색 결과
            {% elif searchType == 'author' %}
            '{{ pr_text }}'에 대한 검색 결과
            {% elif searchType == 'category' %}
            '{{ pr_text }}'카테고리에 대한 검색 결과
            {% endif %}
            {% for i in response.item %}
            <td>
                <a href="{% url 'board:detail' pk=i.isbn13 %}"><img src="{{ i.cover }}" alt="책 이미지" style="width: 150px; height: 200px;"></a>
            </td>
            {% endfor %}
        </tr>
        <tr>
            {% for i in response.item %}
            <td>{{ i.title }}</td>
            {% endfor %}
        </tr>
        <tr>
            {% for i in response.item %}
            <td>-{{ i.author }}</td>
            {% endfor %}
        </tr>                
        <tr>
            {% for i in response.item %}
            <td>출간일: {{ i.pubDate }}</td>
            {% endfor %}
        </tr>
        <tr>
            {% for i in response.item %}
            <td>평점: {{ i.customerReviewRank }}</td>
            {% endfor %}
        </tr>
        {% elif response.status == 'empty' %}
        '{{ pr_text }}' 카테고리에 대한 검색결과가 없습니다.
        {% elif response.totalResults == 0 %}
        '{{ pr_text }}'에 대한 검색결과가 없습니다.
        {% else %}
        검색어를 입력해주세요.
        {% endif %}


{% endblock %}